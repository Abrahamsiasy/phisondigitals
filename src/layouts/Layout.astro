---
import Footer from "../components/elements/Footer.astro";
import Navbar from "../components/elements/Navbar.astro";
import "../styles/global.css";

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  canonical?: string;
}

const { 
  title, 
  description = "GojoTech PLC - Ethiopia's premier technology company specializing in e-commerce solutions, online shop development, foreign consulting, and custom software development. Founded by Abraham Sisay, Negusu Sisay, and Samson Tesfaye.", 
  keywords = "e-commerce, online shop, GojoTech, Abraham Sisay, Negusu Sisay, Samson Tesfaye, Ethiopia technology, academic journals,software development, foreign consulting, GojoShop.et, customer wallet system, order management, POS system, Laravel, MySQL, Firebase, academic publishing, OJS support, Addis Ababa, Ethiopian tech company ojs ojsethiopia",
  canonical 
} = Astro.props;

const fullTitle = `GojoTech PLC - ${title}`;
const fullDescription = description;
const fullKeywords = keywords;
const canonicalUrl = canonical || Astro.url.href;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/gojo-favicon.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="/gojo-favicon.ico" />
    <link rel="apple-touch-icon" href="/gojo-favicon.ico" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Primary Meta Tags -->
    <title>{fullTitle}</title>
    <meta name="title" content={fullTitle} />
    <meta name="description" content={fullDescription} />
    <meta name="keywords" content={fullKeywords} />
    <meta name="author" content="GojoTech PLC - Abraham Sisay, Negusu Sisay, Samson Tesfaye" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="language" content="English" />
    <meta name="geo.region" content="ET" />
    <meta name="geo.placename" content="Addis Ababa, Ethiopia" />
    <meta name="geo.position" content="9.145;40.4897" />
    <meta name="ICBM" content="9.145, 40.4897" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalUrl} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={fullTitle} />
    <meta property="og:description" content={fullDescription} />
    <meta property="og:image" content="https://gojotech.et/og-image.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="GojoTech PLC" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:locale:alternate" content="am_ET" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalUrl} />
    <meta property="twitter:title" content={fullTitle} />
    <meta property="twitter:description" content={fullDescription} />
    <meta property="twitter:image" content="https://gojotech.et/og-image.jpg" />
    <meta property="twitter:creator" content="@gojotech" />
    <meta property="twitter:site" content="@gojotech" />

    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#022E01" />
    <meta name="msapplication-TileColor" content="#022E01" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="GojoTech PLC" />
    <meta name="application-name" content="GojoTech PLC" />
    <meta name="msapplication-TileImage" content="/gojo-favicon.ico" />
    <meta name="msapplication-config" content="/browserconfig.xml" />

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "GojoTech PLC",
      "alternateName": "GojoTech",
      "url": "https://gojotech.et",
      "logo": "https://gojotech.et/logos/gojo-logo.ico",
      "description": "Ethiopia's premier technology company specializing in e-commerce solutions, online shop development, foreign consulting, and custom software development.",
      "foundingDate": "2024",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "ET",
        "addressLocality": "Addis Ababa",
        "addressRegion": "Addis Ababa"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+251-982-808-182",
        "contactType": "customer service",
        "email": "info@gojotech.et",
        "availableLanguage": ["English", "Amharic"]
      },
      "founder": [
        {
          "@type": "Person",
          "name": "Abraham Sisay",
          "jobTitle": "Founder & CEO",
          "worksFor": {
            "@type": "Organization",
            "name": "GojoTech PLC"
          }
        },
        {
          "@type": "Person",
          "name": "Negusu Sisay",
          "jobTitle": "Founder & CTO",
          "worksFor": {
            "@type": "Organization",
            "name": "GojoTech PLC"
          }
        },
        {
          "@type": "Person",
          "name": "Samson Tesfaye",
          "jobTitle": "Founder & COO",
          "worksFor": {
            "@type": "Organization",
            "name": "GojoTech PLC"
          }
        }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Technology Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "E-commerce Solutions",
              "description": "Online shop development and e-commerce platforms including GojoShop.et"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Foreign Consulting",
              "description": "Business setup and consulting services for foreign companies in Ethiopia"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Software Development",
              "description": "Custom software development and enterprise solutions"
            }
          }
        ]
      },
      "sameAs": [
        "https://facebook.com/gojotech",
        "https://linkedin.com/company/gojotech",
        "https://twitter.com/gojotech"
      ],
      "areaServed": {
        "@type": "Country",
        "name": "Ethiopia"
      },
      "serviceArea": {
        "@type": "Country",
        "name": "Ethiopia"
      }
    }
    </script>

    <!-- Local Business Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "GojoTech PLC",
      "image": "https://gojotech.et/logos/gojo-logo.ico",
      "description": "Ethiopia's premier technology company specializing in e-commerce solutions and software development",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "ET",
        "addressLocality": "Addis Ababa"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": 9.145,
        "longitude": 40.4897
      },
      "url": "https://gojotech.et",
      "telephone": "+251-982-808-182",
      "priceRange": "$$",
      "openingHours": "Mo-Fr 09:00-18:00",
      "currenciesAccepted": "ETB, USD",
      "paymentAccepted": "Cash, Credit Card, Bank Transfer"
    }
    </script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Raleway:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="overflow-hidden overflow-y-auto bg-body">
    <Navbar />
    <slot />
    <Footer />
  </body>
  <script>
    // Theme switching with error handling
    try {
      const switchTheme = document.querySelector(
        "[data-switch-theme]"
      ) as HTMLButtonElement;

      if (
        localStorage.getItem("appTheme") === "dark" ||
        (!("appTheme" in localStorage) &&
          window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.classList.add("dark");
      } else {
        document.documentElement.classList.remove("dark");
      }
      
      if (switchTheme) {
        switchTheme.addEventListener("click", (e) => {
          e.preventDefault();
          const doc = document.documentElement;
          if (doc) {
            if (localStorage.getItem("appTheme")) {
              if (localStorage.getItem("appTheme") === "light") {
                doc.classList.add("dark");
                localStorage.setItem("appTheme", "dark");
              } else {
                document.documentElement.classList.remove("dark");
                localStorage.setItem("appTheme", "light");
              }
            } else {
              if (doc.classList.contains("dark")) {
                doc.classList.remove("dark");
                localStorage.setItem("appTheme", "light");
              } else {
                doc.classList.add("dark");
                localStorage.setItem("appTheme", "dark");
              }
            }
          }
        });
      }
    } catch (error) {
      console.error('Theme switching failed:', error);
    }
  </script>
  <script>
    // Navigation with error handling
    try {
      const toggleMenu = document.querySelector(
        "[data-toggle-nav]"
      ) as HTMLButtonElement;
      const navbar = document.querySelector("[data-navbar]") as HTMLDivElement;
      const overlayNav = document.querySelector(
        "[data-nav-overlay]"
      ) as HTMLDivElement;
      
      if (toggleMenu && navbar && overlayNav) {
        toggleMenu.addEventListener("click", e => {
          e.preventDefault();
          if (toggleMenu.getAttribute("data-open-nav") === "false") {
            toggleMenu.setAttribute("data-open-nav", "true");
            overlayNav.setAttribute("data-is-visible", "true");
            document.body.classList.add("!overflow-y-hidden");
            navbar.style.height = `${navbar.scrollHeight}px`
          } else {
            toggleMenu.setAttribute("data-open-nav", "false");
            overlayNav.setAttribute("data-is-visible", "false");
            document.body.classList.remove("!overflow-y-hidden");
            navbar.style.height = "0px"
          }
        });

        navbar.addEventListener("click", () => {
          toggleMenu.setAttribute("data-open-nav", "false");
          overlayNav.setAttribute("data-is-visible", "false");
          document.body.classList.remove("!overflow-y-hidden");
          navbar.style.height = "0px"
        });

        overlayNav.addEventListener("click", () => {
          toggleMenu.setAttribute("data-open-nav", "false");
          overlayNav.setAttribute("data-is-visible", "false");
          document.body.classList.remove("!overflow-y-hidden");
          navbar.style.height = "0px"
        });
      }
    } catch (error) {
      console.error('Navigation initialization failed:', error);
    }
  </script>
  <script>
    // Image optimization and lazy loading
    try {
      const images = document.querySelectorAll('img[loading="lazy"]');
      
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target as HTMLImageElement;
            img.classList.add('loaded');
            observer.unobserve(img);
          }
        });
      });

      images.forEach(img => {
        imageObserver.observe(img);
      });
    } catch (error) {
      console.error('Image optimization failed:', error);
    }
  </script>
</html>
<style is:global>
  /* Consolidated CSS variables - moved from global.css to avoid duplication */
  :root {
    --color-bg: 255 255 255;
    --color-border: 255 255 255;
    --color-box: 255 255 255;
    --box-border: 229 231 235;
    --box-sd: 226 232 240 / 0.5;
    --heading-1: 23 37 84;
    --heading-2: 31 41 55;
    --heading-3: 55 65 81;
  }

  .dark {
    --color-bg: 3 7 18;
    --color-box: 17 24 39;
    --box-border: 243 244 246/0.1;
    --box-sd: transparent;
    --heading-1: 255 255 255;
    --heading-2: 243 244 246;
    --heading-3: 209 213 219;
  }

  html{
    scroll-behavior: smooth;
  }
  body {
    font-family: "Inter", "Raleway", sans-serif;
  }

  [data-toggle-nav][data-open-nav="true"] #line1 {
    transform: translateY(0.375rem) rotate(40deg);
  }
  [data-toggle-nav][data-open-nav="true"] #line2 {
    transform: scaleX(0);
    opacity: 0;
  }
  [data-toggle-nav][data-open-nav="true"] #line3 {
    transform: translateY(-0.375rem) rotate(-40deg);
  }

  [data-nav-overlay][data-is-visible="true"] {
    visibility: visible;
    display: flex;
  }
</style>
